<div th:replace="user/fragment/head"></div>
<title>e-Restaurant</title>
<div th:replace="user/fragment/header"></div>

<!-- =============================================================== -->
<!-- %%%%%%%%%%%%%%%% View section Starts from Here %%%%%%%%%%%%%%%% -->
<!-- =============================================================== -->
<style>
    .customer_details.orderList {
        padding: 60px 0 0 0;
    }

    .orderTop {
        float: left;
        width: 100%;
        padding-bottom: 15px;
    }

    .orderList h2 {
        margin: 0;
        float: left;
        border-bottom: 0;
        padding-top: 10px;
    }

    .search-container {
        float: right;
    }

    .search-container input[type="text"] {
        width: 200px;
        height: 40px;
        padding: 10px;
        border: 1px solid #ccc;
        transition: 0.5s all;
    }

    .search-container input[type="text"]:focus {
        width: 300px;
    }

    .search-container button {
        height: 40px;
        width: 40px;
        margin-left: -5px;
        background: #141617;
        border: 0;
        color: #fff;
        font-size: 17px;
    }

    .orderFilter {
        float: left;
        width: 100%;
        padding: 20px 0;
    }

    .orderFilter select {
        padding: 10px;
        color: #000;
        width: 150px;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: url(images/drrowdropimg.png);
        background-repeat: no-repeat;
        background-position: right;
    }

    .orderFilter label span {
        font-weight: normal;
    }

    .order_tab {
        float: left;
        width: 100%;
        padding: 15px 0;
    }

    .order_tab li {
        width: auto !important;
        cursor: pointer;
    }

    .orderCardWrap {
        float: left;
        width: 100%;
    }

    .orderCard {
        float: left;
        width: 100%;
        border: 1px solid #ccc;
    }

    .orderCard span {
        display: block;
        padding: 0 !important;
        color: #5b5d5d !important;
    }

    .orderHead {
        float: left;
        width: 100%;
        background: #ececec;
        padding: 10px 0 0 10px;
    }

    .orderCard .orderLeft {
        float: left;
        width: 70%;
        list-style-type: none;
        display: flex;
        flex-wrap: wrap;
        padding: 0;
    }

    .orderLeft li {
        width: 22% !important;
        position: relative;
    }

    .orderLeft li .customerName {
        color: #28479c !important;
        cursor: pointer;
    }

    .invoiceDetails {
        float: right;
        width: 30%;
        position: relative;
    }

    .invoiceDetails span {
        display: inline-block;
    }

    .cstmrInfo {
        background: #fff;
        width: 200px;
        position: absolute;
        bottom: -80px;
        left: 0;
        border: 1px solid #ececec;
        display: none !important;
        -webkit-box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
        -moz-box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
        box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
    }

    .cstmrInfo strong {
        display: block;
    }

    .orderCard .orderLeft li p {
        margin: 0;
        padding-bottom: 10px;
    }

    .orderLeft li p:hover .cstmrInfo {
        display: block !important;
        padding: 10px !important;
    }

    .invioceModel {
        background: #fff;
        width: 200px;
        position: absolute;
        top: 60px;
        padding: 10px;
        left: 0;
        border: 1px solid #ececec;
        display: none;
        -webkit-box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
        -moz-box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
        box-shadow: 0px 3px 17px -10px rgba(0, 0, 0, 0.75);
    }

    .invioceModel ul {
        display: block;
        margin: 0;
        padding: 0;
        list-style-type: none;
    }

    .invioceModel ul li {
        width: 100%;
        border-bottom: 1px solid #ccc;
        padding: 4px 0;
    }

    .invioceModel ul li:last-child {
        border-bottom: 0;
    }

    .invioceModel span.modelClose {
        position: absolute;
        top: 4px;
        right: 7px;
        cursor: pointer;
    }

    .itemDetails {
        float: left;
        width: 100%;
        padding: 15px 10px;
    }

    .itemDetails h3 {
        font-size: 20px;
        font-weight: 700;
    }

    .itemDetails p {
        line-height: 20px;
        margin: 0;
    }

    .itemInfo {
        float: left;
        width: 70%;
    }

    .itemImg {
        float: left;
        width: 20%;
    }

    .itemImg img {
        width: 100%;
    }

    .itemDesc {
        float: right;
        width: 80%;
    }

    .itemDesc p span {
        display: inline-block;
        color: #28479c !important;
    }

    .itemDesc h4 {
        font-size: 16px;
        color: #28479c;
    }

    .buy_again {
        display: block;
        background: #27479b;
        border: 1px solid transparent;
        padding: 5px 10px;
        color: #fff;
        border-radius: 5px;
        margin: 10px 0;
        transition: 0.5s all;
    }

    .buy_again:hover {
        color: #27479b;
        border: 1px solid #27479b;
        background: #fff;
    }

    .btn_group {
        float: right;
        width: 30%;
    }

    .btn_group button {
        width: 200px;
        float: right;
    }

    .gift_btn {
        margin-bottom: 10px;
        border-radius: 5px;
        border: 1px solid transparent;
        padding: 5px 10px;
        background: #ececec;
        color: #000;
        transition: 0.5s all;
    }

    .gift_btn:hover {
        color: #000;
        border: 1px solid #000;
        background: transparent;
    }

    .order_tab ul.tabs {
        margin: 0px;
        padding: 0px;
        list-style: none;
        border-bottom: 1px solid #ccc;
    }

    ul.tabs li {
        background: none;
        color: #222;
        display: inline-block;
        padding: 10px 15px;
        cursor: pointer;
    }

    ul.tabs li.current {
        border-bottom: 1px solid #28479c;
        color: #28479c;
        font-weight: 600;
    }

    .tab-content1 {
        display: none;
    }

    .tab-content1.current {
        display: inherit;
    }

    .again ul {
        padding: 0;
        list-style-type: none;
        display: flex;
        flex-wrap: wrap;
    }

    .again h2 {
        float: none;
    }

    .again li {
        width: 30% !important;
        text-align: center;
        margin: 0 10px 0 0;
    }

    .again li img {
        width: 120px !important;
    }

    .again li h4 {
        font-size: 16px;
        color: #28479c;
        line-height: 20px;
    }

    .again li .buy_again {
        margin: 10px auto;
        width: 100%;
    }

        .bill { width: 50%; margin: auto; padding: 20px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        .total { font-weight: bold; }
        .center { text-align: center; }
</style>
<!--  views -->
<div class="container" ng-app="IndexModule" ng-controller="OrderListController">
    <div class="customer_details orderList">
        <div class="orderTop">
            <h2 class="hidden-xs">My Orders</h2>
            <div class="search-container">

            </div>
        </div>
        <div class="order_tab">
            <ul class="tabs">
                <li class="tab-link current" data-tab="order_tab">Orders</li>
                <li class="tab-link" data-tab="open_orders">Placed Orders</li>
                <li class="tab-link" data-tab="cancelled_orders">Cancelled Orders</li>
            </ul>
            <div class="orderFilter">
                <label>{{ordersLength}} order <span>placed in</span></label>
                <select>
                    <option value="">Last 30 Days</option>
                    <option value="">Past 6 Month</option>
                    <option value="">2024</option>
                    <option value="">2023</option>
                </select>
            </div>
        </div>
        <div id="order_tab" class="orderCardWrap tab-content1 current">
            <div class="orderCard" ng-repeat="order in orders">
                <div class="orderHead">
                    <ul class="orderLeft">
                        <li>
                            <p>ORDER PLACED <span>{{order.purchaseDate | date:'dd MMM yyyy'}}</span></p>
                        </li>
                        <li>
                            <p>TOTAL <span>&#8377 {{order.totalAmount}}</span></p>
                        </li>
                        <li>
                            <p>SHIP TO <span class="customerName">{{order.orderBy}}</span>
                                <span class="cstmrInfo">
                                    <strong>Customer Name</strong> Lorem Ipsum is simply dummy text
                                </span>
                            </p>

                        </li>
                    </ul>
                    <div class="invoiceDetails">
                        <p ng-if="order.billNo!=0">ORDER # {{order.billNo}} <span><a href="#">Order Details</a></span>
                            <span class="showInvoice"><a href="javascript:void(0)">Invoice <i class="fa fa-chevron-down"
                                        aria-hidden="true"></i></a></span>
                        </p>
                    </div>
                </div>
                <div class="itemDetails">
                    <h3 ng-if="order.delivaryDate!=null">Delivered {{order.delivaryDate}}</h3>
                    <p ng-if="order.delivaryDate!=null">Package was handed to a {{order.orderBy}}</p>
                    <div class="itemInfo">
                        <div class="itemImg">
                            <img ng-src="{{'uploads/' + order.images}}" alt=""
                                style="width: 70%; height: 15vh; border-radius: 20px;">
                        </div>
                        <div class="itemDesc">
                            <h4>{{order.itemName}} (Item of {{order.qty}})</h4>
                            <p>Sold by: <span>E{{order.resturentName}}</span></p>
                            <span class="itemPrice">&#8377{{order.rate}} * {{order.qty}} =
                                &#8377{{order.totalAmount}}</span>
                            <button class="buy_again" ng-click="buyAgain(order.itemId)">Buy it again</button>
                        </div>

                    </div>
                    <div class="btn_group">
                        <button ng-if="order.orderStatus=='P'" class="gift_btn" ng-click="cancelOrder(order.id)"
                            style="background-color: rgb(237, 250, 123); color: #161616;">Cancel Order</button>
                        <button ng-if="order.billNo!=0" class="gift_btn"
                            style="background-color: rgb(87, 99, 121); color: #ececec;" data-bs-toggle="modal"
                            data-bs-target="#viewBill" ng-click="viewBill(order.id)">Order receipt</button>
                        <button class="gift_btn" ng-if="order.orderStatus=='D'">Feedback</button>
                        <button class="gift_btn" style="background-color: rgb(243, 66, 42); color: #ececec;"
                            ng-if="order.orderStatus=='C'">Cancelled</button>

                    </div>
                    <div ng-if="order.orderStatus=='A'">
                        <p><span>Expected Delivary:</span> {{order.expectedDelivary | date: 'dd MMM yyyy, hh:mm:ss a'}}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ****************************Modal Start****************************** -->
        <div class="modal fade modal-custom" id="viewBill" tabindex="-1" aria-labelledby="newWorkshopsLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="newWorkshopsLabel">
                            <span>Bill</span>
                            <span class="icon-common icon-modal-header icon-add-circle"></span>
                        </h1>
                    </div>
                    <div class="modal-body" id="billPrint">
                        <div id="bill" class="bill">
                            <p><strong>Date:</strong> {{billDate}}</p>
                            <p><strong>Invoice No:</strong> {{billNo}}</p>

                            <table>
                                <tr>
                                    <th>Item</th>
                                    <th>Qty</th>
                                    <th>Price</th>
                                    <th>Total</th>
                                </tr>
                                <tr>
                                    <td>{{item}}</td>
                                    <td>{{qty}}</td>
                                    <td>{{rate | currency:"₹"}}</td>
                                    <td>{{qty * rate | currency:"₹"}}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="total">Sub Total</td>
                                    <td>{{netAmount | currency:"₹"}}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="total">CGST (5%)</td>
                                    <td>{{cgst | currency:"₹"}}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="total">SGST (5%)</td>
                                    <td>{{sgst | currency:"₹"}}</td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="total">Grand Total</td>
                                    <td>{{total | currency:"₹"}}</td>
                                </tr>
                            </table>

                            <p><strong>Payment Mode:</strong> {{payMode}}</p>
                            <button class="btn btn-primary" ng-click="printBill()">Print Bill</button>
                        <button class="btn btn-danger" ng-click="generatePDF()">Download PDF</button>
                        </div>

                        
                    </div>
                </div>
            </div>
            <!-- ****************************Modal End****************************** -->
        </div>
    </div>



</div>

    <!-- =============================================================== -->
    <!-- %%%%%%%%%%%%%%%% View section END Here %%%%%%%%%%%%%%%% -->
    <!-- =============================================================== -->
    <script>
        $(".showInvoice").click(function () {
            $(".invioceModel").show();
        });
        $(".modelClose").click(function () {
            jQuery(this).parent(".invioceModel").hide();
        })

        jQuery('.order_tab ul.tabs li').click(function () {
            var tab_id = jQuery(this).attr('data-tab');

            jQuery('.order_tab ul.tabs li').removeClass('current');
            jQuery('.tab-content1').removeClass('current');

            jQuery(this).addClass('current');
            jQuery("#" + tab_id).addClass('current');
        })


    </script>

    <script src="assets/js/jquery.min.js" type="text/javascript"></script>
    <script src="assets/js/angular.min.js" type="text/javascript"></script>
    <script src="assets/js/angular-sanitize.js" type="text/javascript"></script>
    <script src="assets/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <script src="assets/js/flatpickr.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <!-- <script src="assets/js/flatpickr.min.js" type="text/javascript"></script> -->
    <script>
        //function to custom menu dropdown
        //to use this set menuToggle(this) function to the element, and add .menu-item class to the container element
        function menuToggle(menuToggle) {
            var clickedItem = menuToggle.closest('.menu-item'); //calling the conatiner menu

            clickedItem.classList.remove('menu-temp-active'); //removing the class from .menu-item element

            var isMenuActive = clickedItem.classList.contains('menu-active');
            // Remove the active class from all elements
            var elements = document.getElementsByClassName('menu-item');
            for (var i = 0; i < elements.length; i++) {
                elements[i].classList.remove('menu-active');
            }

            // Toggle the class of the clicked element
            if (!isMenuActive) {
                clickedItem.classList.add('menu-active');
            }
        }

        if (window.innerWidth > 991) {
            function tempMenuOpen(activeMenu) {
                var clickedItem = activeMenu.closest('.menu-item'); //calling the conatiner menu

                clickedItem.classList.add('menu-temp-active'); //adding the class along with .menu-item
            }

            function tempMenuClose(deactiveMenu) {
                var clickedItem = deactiveMenu.closest('.menu-item'); //calling the conatiner menu

                clickedItem.classList.remove('menu-temp-active'); //removing the class from .menu-item element
            }
        }
        var showHideLoad = function (hideIndicator) {
            if (typeof hideIndicator === "undefined" || hideIndicator === null) {
                // console.log('data');
                $('#overlay').show();
            } else {
                // console.log('data1');
                $('#overlay').hide();
            }
        };

        function collapseExpandDesc(event) {
            event.preventDefault(); // Prevent the default behavior of the link

            // Find the parent item-description-container of the clicked link
            var container = event.target.closest('.description-collapse-expand');

            // Toggle the .expand class on the found container
            container.classList.toggle('expand');
        }
    </script>

    <script src="private/index.js"></script>
    </body>

    </html>